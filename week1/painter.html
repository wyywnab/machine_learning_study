<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é»‘ç™½ç”»å›¾æ¿ - æœºå™¨å­¦ä¹ æ•°æ®ç”Ÿæˆ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #f5f7fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .subtitle {
            font-size: 1rem;
            color: #7f8c8d;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .app-container {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
        }
        
        .control-section {
            flex: 1;
            min-width: 300px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }
        
        .canvas-section {
            flex: 2;
            min-width: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .output-section {
            flex: 1;
            min-width: 300px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }
        
        .setting-group {
            margin-bottom: 20px;
        }
        
        .setting-group h3 {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        
        .setting-group h3 i {
            margin-right: 8px;
            font-size: 1.2rem;
        }
        
        .input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .input-group {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: #34495e;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: #3498db;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 0.95rem;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-success {
            background: #2ecc71;
        }
        
        .btn-success:hover {
            background: #27ae60;
        }
        
        .canvas-container {
            background: #ecf0f1;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            justify-content: center;
            overflow: auto;
            margin-bottom: 20px;
            max-height: 70vh;
        }
        
        .drawing-canvas {
            display: grid;
            gap: 1px;
            background: #bdc3c7;
            border: 1px solid #95a5a6;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .pixel {
            background: white;
            cursor: pointer;
            transition: background 0.1s;
        }
        
        .pixel.black {
            background: #2c3e50;
        }
        
        .pixel.edge {
            background: #95a5a6;
        }
        
        .transform-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-group input {
            width: auto;
        }
        
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .output-title {
            font-size: 1.2rem;
            color: #2c3e50;
        }
        
        .array-output {
            background: white;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            height: 250px;
            overflow: auto;
            white-space: pre;
            color: #2c3e50;
            border: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 12px 20px;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(200%);
            transition: transform 0.5s;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .tool-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .edge-options {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .input-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>é»‘ç™½ç”»å›¾æ¿</h1>
        <p class="subtitle">è‡ªå®šä¹‰å°ºå¯¸ç»˜åˆ¶å›¾åƒå¹¶ç”Ÿæˆ0-1é˜µåˆ—ï¼Œæ”¯æŒè¾¹ç¼˜æµ…è‰²å—</p>
    </header>
    
    <div class="container">
        <div class="app-container">
            <div class="control-section">
                <div class="setting-group">
                    <h3><i>âš™ï¸</i> ç½‘æ ¼è®¾ç½®</h3>
                    <div class="input-row">
                        <div class="input-group">
                            <label for="gridWidth">å®½åº¦ (8-32)</label>
                            <input type="number" id="gridWidth" min="8" max="32" value="28">
                        </div>
                        <div class="input-group">
                            <label for="gridHeight">é«˜åº¦ (8-32)</label>
                            <input type="number" id="gridHeight" min="8" max="32" value="28">
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="pixelSize">åƒç´ å¤§å°</label>
                        <select id="pixelSize">
                            <option value="15">å°</option>
                            <option value="20" selected>ä¸­</option>
                            <option value="25">å¤§</option>
                        </select>
                    </div>
                    <button id="createGridBtn" class="btn-success" style="margin-top: 15px;">åˆ›å»ºç½‘æ ¼</button>
                </div>
                
                <div class="setting-group">
                    <h3><i>ğŸ¨</i> ç»˜å›¾å·¥å…·</h3>
                    <div class="tool-buttons">
                        <button id="drawBtn" class="btn-success">ç”»ç¬”</button>
                        <button id="eraseBtn">æ©¡çš®æ“¦</button>
                        <button id="clearBtn" class="btn-danger">æ¸…ç©ºç”»å¸ƒ</button>
                    </div>
                </div>
                
                <div class="setting-group">
                    <h3><i>ğŸ”„</i> å›¾åƒå˜æ¢</h3>
                    <div class="transform-options">
                        <div class="checkbox-group">
                            <input type="checkbox" id="rotateOption">
                            <label for="rotateOption">é€†æ—¶é’ˆæ—‹è½¬90åº¦</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="mirrorOption">
                            <label for="mirrorOption">å·¦å³é•œåƒ</label>
                        </div>
                    </div>
                </div>
                
                <div class="setting-group edge-options">
                    <h3><i>ğŸ”</i> è¾¹ç¼˜æ•ˆæœ</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="edgeEffect" checked>
                        <label for="edgeEffect">å¯ç”¨è¾¹ç¼˜æµ…è‰²å—</label>
                    </div>
                    <div class="input-group" style="margin-top: 10px;">
                        <label for="edgeValue">è¾¹ç¼˜å€¼ (0.1-0.9)</label>
                        <input type="number" id="edgeValue" min="0.1" max="0.9" step="0.1" value="0.3">
                    </div>
                </div>
            </div>
            
            <div class="canvas-section">
                <div class="canvas-container">
                    <div class="drawing-canvas" id="drawingCanvas"></div>
                </div>
                <div style="text-align: center;">
                    <button id="generateBtn" class="btn-success">ç”Ÿæˆé˜µåˆ—</button>
                </div>
            </div>
            
            <div class="output-section">
                <div class="output-header">
                    <h3 class="output-title">ç”Ÿæˆçš„é˜µåˆ—</h3>
                    <button id="copyBtn">å¤åˆ¶åˆ°å‰ªè´´æ¿</button>
                </div>
                <pre class="array-output" id="arrayOutput">è¯·å…ˆåˆ›å»ºç½‘æ ¼å¹¶ç»˜åˆ¶å›¾åƒï¼Œç„¶åç‚¹å‡»"ç”Ÿæˆé˜µåˆ—"æŒ‰é’®</pre>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">é˜µåˆ—å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // è·å–DOMå…ƒç´ 
            const canvas = document.getElementById('drawingCanvas');
            const gridWidthInput = document.getElementById('gridWidth');
            const gridHeightInput = document.getElementById('gridHeight');
            const pixelSizeSelect = document.getElementById('pixelSize');
            const createGridBtn = document.getElementById('createGridBtn');
            const drawBtn = document.getElementById('drawBtn');
            const eraseBtn = document.getElementById('eraseBtn');
            const clearBtn = document.getElementById('clearBtn');
            const generateBtn = document.getElementById('generateBtn');
            const copyBtn = document.getElementById('copyBtn');
            const arrayOutput = document.getElementById('arrayOutput');
            const rotateOption = document.getElementById('rotateOption');
            const mirrorOption = document.getElementById('mirrorOption');
            const edgeEffect = document.getElementById('edgeEffect');
            const edgeValueInput = document.getElementById('edgeValue');
            const notification = document.getElementById('notification');
            
            // åˆå§‹åŒ–å˜é‡
            let isDrawing = false;
            let currentTool = 'draw';
            let gridWidth = parseInt(gridWidthInput.value);
            let gridHeight = parseInt(gridHeightInput.value);
            let pixelSize = parseInt(pixelSizeSelect.value);
            let edgeValue = parseFloat(edgeValueInput.value);
            
            // åˆ›å»ºç”»å¸ƒç½‘æ ¼
            function createCanvas() {
                gridWidth = parseInt(gridWidthInput.value);
                gridHeight = parseInt(gridHeightInput.value);
                pixelSize = parseInt(pixelSizeSelect.value);
                edgeValue = parseFloat(edgeValueInput.value);
                
                // éªŒè¯è¾“å…¥
                if (gridWidth < 8 || gridWidth > 32 || gridHeight < 8 || gridHeight > 32) {
                    alert('å®½åº¦å’Œé«˜åº¦å¿…é¡»åœ¨8åˆ°32ä¹‹é—´');
                    return;
                }
                
                canvas.innerHTML = '';
                canvas.style.gridTemplateColumns = `repeat(${gridWidth}, ${pixelSize}px)`;
                canvas.style.gridTemplateRows = `repeat(${gridHeight}, ${pixelSize}px)`;
                
                for (let i = 0; i < gridHeight; i++) {
                    for (let j = 0; j < gridWidth; j++) {
                        const pixel = document.createElement('div');
                        pixel.classList.add('pixel');
                        pixel.dataset.x = j;
                        pixel.dataset.y = i;
                        pixel.dataset.value = '0'; // é»˜è®¤ç™½è‰²
                        
                        pixel.addEventListener('mousedown', startDrawing);
                        pixel.addEventListener('mouseenter', draw);
                        
                        canvas.appendChild(pixel);
                    }
                }
                
                // æ·»åŠ å…¨å±€é¼ æ ‡äº‹ä»¶
                document.addEventListener('mouseup', stopDrawing);
            }
            
            // å¼€å§‹ç»˜åˆ¶
            function startDrawing(e) {
                isDrawing = true;
                draw(e);
            }
            
            // ç»˜åˆ¶å‡½æ•°
            function draw(e) {
                if (!isDrawing) return;
                
                const pixel = e.target;
                if (currentTool === 'draw') {
                    // è®¾ç½®å½“å‰åƒç´ ä¸ºé»‘è‰²
                    pixel.classList.add('black');
                    pixel.classList.remove('edge');
                    pixel.dataset.value = '1';
                    
                    // æ·»åŠ è¾¹ç¼˜æ•ˆæœ
                    if (edgeEffect.checked) {
                        addEdgeEffect(pixel);
                    }
                } else if (currentTool === 'erase') {
                    // æ“¦é™¤å½“å‰åƒç´ 
                    pixel.classList.remove('black');
                    pixel.classList.remove('edge');
                    pixel.dataset.value = '0';
                }
            }
            
            // æ·»åŠ è¾¹ç¼˜æ•ˆæœ
            function addEdgeEffect(centerPixel) {
                const x = parseInt(centerPixel.dataset.x);
                const y = parseInt(centerPixel.dataset.y);
                
                // æ£€æŸ¥å‘¨å›´çš„8ä¸ªåƒç´ 
                for (let i = -1; i <= 1; i++) {
                    for (let j = -1; j <= 1; j++) {
                        if (i === 0 && j === 0) continue; // è·³è¿‡ä¸­å¿ƒåƒç´ 
                        
                        const nx = x + j;
                        const ny = y + i;
                        
                        // ç¡®ä¿åœ¨ç½‘æ ¼èŒƒå›´å†…
                        if (nx >= 0 && nx < gridWidth && ny >= 0 && ny < gridHeight) {
                            const neighborIndex = ny * gridWidth + nx;
                            const neighborPixel = canvas.children[neighborIndex];
                            
                            // å¦‚æœé‚»å±…ä¸æ˜¯é»‘è‰²ä¸”ä¸æ˜¯è¾¹ç¼˜ï¼Œåˆ™è®¾ç½®ä¸ºè¾¹ç¼˜
                            if (!neighborPixel.classList.contains('black') && 
                                !neighborPixel.classList.contains('edge')) {
                                neighborPixel.classList.add('edge');
                                neighborPixel.dataset.value = edgeValue.toString();
                            }
                        }
                    }
                }
            }
            
            // åœæ­¢ç»˜åˆ¶
            function stopDrawing() {
                isDrawing = false;
            }
            
            // æ¸…ç©ºç”»å¸ƒ
            function clearCanvas() {
                const pixels = document.querySelectorAll('.pixel');
                pixels.forEach(pixel => {
                    pixel.classList.remove('black');
                    pixel.classList.remove('edge');
                    pixel.dataset.value = '0';
                });
            }
            
            // ç”Ÿæˆé˜µåˆ—
            function generateArray() {
                const pixels = document.querySelectorAll('.pixel');
                if (pixels.length === 0) {
                    arrayOutput.textContent = "è¯·å…ˆåˆ›å»ºç½‘æ ¼ï¼";
                    return "";
                }
                
                let array = [];
                
                for (let i = 0; i < gridHeight; i++) {
                    let row = [];
                    for (let j = 0; j < gridWidth; j++) {
                        const index = i * gridWidth + j;
                        row.push(pixels[index].dataset.value);
                    }
                    array.push(row);
                }
                

                // åº”ç”¨å˜æ¢
                if (mirrorOption.checked) {
                    array = mirrorHorizontally(array);
                }
                if (rotateOption.checked) {
                    array = rotate90CounterClockwise(array);
                }
                
                // æ ¼å¼åŒ–è¾“å‡º
                let output = '[\n';
                array.forEach(row => {
                    output += '  [' + row.join(', ') + '],\n';
                });
                output = output.slice(0, -2) + '\n]';
                
                arrayOutput.textContent = output;
                return output;
            }
            
            // é€†æ—¶é’ˆæ—‹è½¬90åº¦
            function rotate90CounterClockwise(matrix) {
                const rows = matrix.length;
                const cols = matrix[0].length;
                const rotated = [];
                
                for (let j = cols - 1; j >= 0; j--) {
                    const newRow = [];
                    for (let i = 0; i < rows; i++) {
                        newRow.push(matrix[i][j]);
                    }
                    rotated.push(newRow);
                }
                
                return rotated;
            }
            
            // å·¦å³é•œåƒ
            function mirrorHorizontally(matrix) {
                return matrix.map(row => [...row].reverse());
            }
            
            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            function copyToClipboard() {
                const text = arrayOutput.textContent;
                if (text.includes('è¯·å…ˆ') || text.trim() === '') {
                    showNotification('è¯·å…ˆç”Ÿæˆé˜µåˆ—ï¼');
                    return;
                }
                
                navigator.clipboard.writeText(text)
                    .then(() => {
                        showNotification('é˜µåˆ—å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    })
                    .catch(err => {
                        showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                    });
            }
            
            // æ˜¾ç¤ºé€šçŸ¥
            function showNotification(message) {
                notification.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // äº‹ä»¶ç›‘å¬å™¨
            createGridBtn.addEventListener('click', createCanvas);
            
            drawBtn.addEventListener('click', () => {
                currentTool = 'draw';
                drawBtn.classList.add('btn-success');
                eraseBtn.classList.remove('btn-success');
            });
            
            eraseBtn.addEventListener('click', () => {
                currentTool = 'erase';
                eraseBtn.classList.add('btn-success');
                drawBtn.classList.remove('btn-success');
            });
            
            clearBtn.addEventListener('click', clearCanvas);
            
            generateBtn.addEventListener('click', generateArray);
            
            copyBtn.addEventListener('click', copyToClipboard);
            
            // åˆå§‹åŒ–ç”»å¸ƒ
            createCanvas();
        });
    </script>
</body>
</html>